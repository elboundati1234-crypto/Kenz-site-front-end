<div class="min-vh-100 d-flex align-items-center justify-content-center px-3 py-5">
  <div style="max-width: 640px; width: 100%;">
    <div class="text-center mb-5">
      <h1 class="h2 fw-bold text-dark mb-2">Kenz</h1>
      <p class="text-secondary">Create your account</p>
    </div>

    <div class="bg-white rounded-3 shadow-sm p-5">
      <div class="mb-5">
        <div class="d-flex align-items-center justify-content-between">
          <div class="d-flex align-items-center gap-3" style="flex: 1;">
            <div
              class="rounded-circle d-flex align-items-center justify-content-center text-white fw-500"
              [style.width]="'32px'"
              [style.height]="'32px'"
              [style.backgroundColor]="currentStep === 1 ? '#2563EB' : '#e5e7eb'"
              [style.color]="currentStep === 1 ? 'white' : '#6b7280'"
            >
              1
            </div>
            <span class="small fw-500" [class.text-primary]="currentStep === 1" [class.text-secondary]="currentStep !== 1">
              Basic Information
            </span>
          </div>
          <div class="flex-grow-1 mx-2" style="height: 2px; background-color: #e5e7eb;"></div>
          <div class="d-flex align-items-center gap-3" style="flex: 1; justify-content: flex-end;">
            <div
              class="rounded-circle d-flex align-items-center justify-content-center text-white fw-500"
              [style.width]="'32px'"
              [style.height]="'32px'"
              [style.backgroundColor]="currentStep === 2 ? '#2563EB' : '#e5e7eb'"
              [style.color]="currentStep === 2 ? 'white' : '#6b7280'"
            >
              2
            </div>
            <span class="small fw-500" [class.text-primary]="currentStep === 2" [class.text-secondary]="currentStep !== 2">
              Additional Information
            </span>
          </div>
        </div>
        <p class="text-center text-secondary small mt-3 mb-0">Step {{ currentStep }} of 2</p>
      </div>

      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
        <div *ngIf="currentStep === 1">
          <div class="row g-3 mb-4">
            <div class="col-12 col-md-6">
              <label for="lastName" class="form-label fw-500">Last Name <span class="text-danger">*</span></label>
              <div class="input-group">
                <span class="input-group-text border-0 bg-light">
                  <lucide-icon [img]="UserIcon" class="text-secondary" style="width: 20px; height: 20px;"></lucide-icon>
                </span>
                <input
                  id="lastName"
                  type="text"
                  formControlName="lastName"
                  class="form-control border-0 bg-light"
                  placeholder="Doe"
                />
              </div>
              <div *ngIf="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched" class="mt-2 text-danger small">
                Last name is required
              </div>
            </div>

            <div class="col-12 col-md-6">
              <label for="firstName" class="form-label fw-500">First Name <span class="text-danger">*</span></label>
              <div class="input-group">
                <span class="input-group-text border-0 bg-light">
                  <lucide-icon [img]="UserIcon" class="text-secondary" style="width: 20px; height: 20px;"></lucide-icon>
                </span>
                <input
                  id="firstName"
                  type="text"
                  formControlName="firstName"
                  class="form-control border-0 bg-light"
                  placeholder="John"
                />
              </div>
              <div *ngIf="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched" class="mt-2 text-danger small">
                First name is required
              </div>
            </div>
          </div>

          <div class="mb-4">
            <label for="email" class="form-label fw-500">Email <span class="text-danger">*</span></label>
            <div class="input-group">
              <span class="input-group-text border-0 bg-light">
                <lucide-icon [img]="MailIcon" class="text-secondary" style="width: 20px; height: 20px;"></lucide-icon>
              </span>
              <input
                id="email"
                type="email"
                formControlName="email"
                class="form-control border-0 bg-light"
                placeholder="john.doe@email.com"
              />
            </div>
            <div *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched" class="mt-2 text-danger small">
              Please enter a valid email address
            </div>
          </div>

          <div class="mb-4">
            <label for="password" class="form-label fw-500">Password <span class="text-danger">*</span></label>
            <div class="input-group">
              <span class="input-group-text border-0 bg-light">
                <lucide-icon [img]="LockIcon" class="text-secondary" style="width: 20px; height: 20px;"></lucide-icon>
              </span>
              <input
                id="password"
                [type]="showPassword ? 'text' : 'password'"
                formControlName="password"
                class="form-control border-0 bg-light"
                placeholder="••••••••"
              />
              <button
                type="button"
                (click)="togglePassword()"
                class="btn btn-light border-0"
              >
                <lucide-icon
                  [img]="showPassword ? EyeOffIcon : EyeIcon"
                  class="text-secondary"
                  style="width: 20px; height: 20px;"
                ></lucide-icon>
              </button>
            </div>
            <div *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched" class="mt-2 text-danger small">
              Password must be at least 6 characters long
            </div>
          </div>

          <div class="mb-4">
            <label for="confirmPassword" class="form-label fw-500">Confirm Password <span class="text-danger">*</span></label>
            <div class="input-group">
              <span class="input-group-text border-0 bg-light">
                <lucide-icon [img]="LockIcon" class="text-secondary" style="width: 20px; height: 20px;"></lucide-icon>
              </span>
              <input
                id="confirmPassword"
                [type]="showConfirmPassword ? 'text' : 'password'"
                formControlName="confirmPassword"
                class="form-control border-0 bg-light"
                placeholder="••••••••"
              />
              <button
                type="button"
                (click)="toggleConfirmPassword()"
                class="btn btn-light border-0"
              >
                <lucide-icon
                  [img]="showConfirmPassword ? EyeOffIcon : EyeIcon"
                  class="text-secondary"
                  style="width: 20px; height: 20px;"
                ></lucide-icon>
              </button>
            </div>
            <div *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched" class="mt-2 text-danger small">
              <span *ngIf="registerForm.get('confirmPassword')?.hasError('required')">
                Password confirmation is required
              </span>
              <span *ngIf="registerForm.get('confirmPassword')?.hasError('passwordMismatch')">
                Passwords do not match
              </span>
            </div>
          </div>

          <div class="mb-4">
            <label for="studyLevel" class="form-label fw-500">Study Level <span class="text-danger">*</span></label>
            <div class="input-group">
              <span class="input-group-text border-0 bg-light">
                <lucide-icon [img]="GraduationCapIcon" class="text-secondary" style="width: 20px; height: 20px;"></lucide-icon>
              </span>
              <select
                id="studyLevel"
                formControlName="studyLevel"
                class="form-select border-0 bg-light"
              >
                <option value="">Select a level</option>
                <option value="Licence">Bachelor's</option>
                <option value="Master">Master's</option>
                <option value="Doctorat">PhD</option>
              </select>
            </div>
            <div *ngIf="registerForm.get('studyLevel')?.invalid && registerForm.get('studyLevel')?.touched" class="mt-2 text-danger small">
              Study level is required
            </div>
          </div>

          <div class="mb-4">
            <label for="studyDomain" class="form-label fw-500">Study Domain <span class="text-danger">*</span></label>
            <div class="input-group">
              <span class="input-group-text border-0 bg-light">
                <lucide-icon [img]="BookOpenIcon" class="text-secondary" style="width: 20px; height: 20px;"></lucide-icon>
              </span>
              <select
                id="studyDomain"
                formControlName="studyDomain"
                class="form-select border-0 bg-light"
              >
                <option value="">Select a domain</option>
                <option value="Informatique">Computer Science</option>
                <option value="Droit">Law</option>
                <option value="Médecine">Medicine</option>
                <option value="Économie">Economics</option>
                <option value="Ingénierie">Engineering</option>
                <option value="Sciences Humaines">Humanities</option>
              </select>
            </div>
            <div *ngIf="registerForm.get('studyDomain')?.invalid && registerForm.get('studyDomain')?.touched" class="mt-2 text-danger small">
              Study domain is required
            </div>
          </div>

          <div class="d-flex justify-content-end pt-3">
            <button
              type="button"
              (click)="nextStep()"
              [disabled]="!isStep1Valid()"
              class="btn btn-primary px-4"
            >
              Next
            </button>
          </div>
        </div>

        <div *ngIf="currentStep === 2">
          <div class="mb-4">
            <label for="phone" class="form-label fw-500">Phone Number</label>
            <div class="input-group">
              <span class="input-group-text border-0 bg-light">
                <lucide-icon [img]="PhoneIcon" class="text-secondary" style="width: 20px; height: 20px;"></lucide-icon>
              </span>
              <input
                id="phone"
                type="tel"
                formControlName="phone"
                class="form-control border-0 bg-light"
                placeholder="+33 6 12 34 56 78"
              />
            </div>
          </div>

          <div class="mb-4">
            <label for="targetCountries" class="form-label fw-500">Target Countries</label>
            <div class="input-group">
              <span class="input-group-text border-0 bg-light">
                <lucide-icon [img]="GlobeIcon" class="text-secondary" style="width: 20px; height: 20px;"></lucide-icon>
              </span>
              <input
                id="targetCountries"
                type="text"
                formControlName="targetCountries"
                class="form-control border-0 bg-light"
                placeholder="France, Canada, Germany (separated by commas)"
              />
            </div>
          </div>

          <div class="mb-4">
            <label for="secondaryDomain" class="form-label fw-500">Secondary Domain</label>
            <div class="input-group">
              <span class="input-group-text border-0 bg-light">
                <lucide-icon [img]="BookOpenIcon" class="text-secondary" style="width: 20px; height: 20px;"></lucide-icon>
              </span>
              <select
                id="secondaryDomain"
                formControlName="secondaryDomain"
                class="form-select border-0 bg-light"
              >
                <option value="">Select a secondary domain</option>
                <option value="Informatique">Computer Science</option>
                <option value="Droit">Law</option>
                <option value="Médecine">Medicine</option>
                <option value="Économie">Economics</option>
                <option value="Ingénierie">Engineering</option>
                <option value="Sciences Humaines">Humanities</option>
              </select>
            </div>
          </div>

          <div class="mb-4">
            <div class="form-check mb-3">
              <input
                id="acceptTerms"
                type="checkbox"
                formControlName="acceptTerms"
                class="form-check-input"
              />
              <label for="acceptTerms" class="form-check-label small">
                I accept the privacy policy and terms of use
              </label>
            </div>

            <div class="form-check">
              <input
                id="acceptNotifications"
                type="checkbox"
                formControlName="acceptNotifications"
                class="form-check-input"
              />
              <label for="acceptNotifications" class="form-check-label small">
                I agree to receive email notifications about my activities
              </label>
            </div>
          </div>

          <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show" role="alert">
            <p class="mb-0 small">{{ errorMessage }}</p>
          </div>

          <div class="d-flex gap-2 pt-3">
            <button
              type="button"
              (click)="skipAdditionalInfo()"
              class="btn btn-outline-secondary flex-grow-1"
            >
              Skip
            </button>
            <button
              type="submit"
              [disabled]="loading || !isStep2Valid()"
              class="btn btn-primary flex-grow-1"
            >
              {{ loading ? 'Registering...' : 'Register' }}
            </button>
          </div>
        </div>
      </form>

      <div class="text-center mt-4">
        <p class="text-secondary small mb-0">
          Already have an account?
          <a routerLink="/login" class="link-primary text-decoration-none fw-500">
            Log in
          </a>
        </p>
      </div>
    </div>
  </div>
</div>
